<!DOCTYPE html>
<html lang="en">
<head>
  <title>AstroPulse Instagram Booster</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <style>
    :root {
      --astro-purple: #8B5CF6;
      --nebula-pink: #EC4899;
      --cosmic-teal: #06B6D4;
      --star-white: #F8FAFC;
      --dark-bg: #0f0f23;
      --border-color: rgba(139, 92, 246, 0.3);
      --glow: 0 0 20px rgba(139, 92, 246, 0.4);
      --success-green: #10B981;
      --telegram-blue: #0088cc;
      --error-red: #EF4444;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Orbitron', 'Roboto Mono', monospace;
      background: linear-gradient(135deg, #1e1b4b 0%, #1e3a8a 50%, #1e3a8a 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      position: relative;
      overflow-x: hidden;
      line-height: 1.5;
    }

    .container {
      max-width: 420px;
      width: 100%;
      position: relative;
      z-index: 10;
    }

    /* TELEGRAM FLOATING BUTTON */
    .telegram-float {
      position: fixed;
      bottom: 24px;
      right: 24px;
      width: 64px;
      height: 64px;
      background: var(--telegram-blue);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 8px 32px rgba(0, 136, 204, 0.4);
      z-index: 1001;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: 2px solid rgba(255,255,255,0.2);
      backdrop-filter: blur(16px);
      opacity: 0;
      transform: scale(0) translate(8px, 8px);
      text-decoration: none;
    }

    .telegram-float.show {
      opacity: 1;
      transform: scale(1) translate(0, 0);
    }

    .telegram-float:hover {
      transform: scale(1.05);
      box-shadow: 0 12px 40px rgba(0, 136, 204, 0.5);
    }

    @keyframes pulse-telegram {
      0%, 100% { box-shadow: 0 0 0 0 rgba(0, 136, 204, 0.7); }
      50% { box-shadow: 0 0 0 16px rgba(0, 136, 204, 0); }
    }

    .telegram-float.pulse { animation: pulse-telegram 2s infinite; }
    .telegram-float.hidden { display: none !important; }

    /* MODALS */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(12px);
      z-index: 1000;
      display: none;
      justify-content: center;
      align-items: center;
      padding: 1rem;
    }

    .modal.show { display: flex; }

    .modal-content {
      background: var(--dark-bg);
      backdrop-filter: blur(24px);
      border: 1px solid var(--border-color);
      border-radius: 24px;
      padding: 2rem;
      max-width: 400px;
      width: 100%;
      text-align: center;
      box-shadow: 0 32px 64px rgba(0,0,0,0.6), var(--glow);
      position: relative;
      max-height: 90vh;
      overflow-y: auto;
    }

    .close-btn {
      position: absolute;
      top: 1rem;
      right: 1.5rem;
      background: none;
      border: none;
      color: var(--star-white);
      font-size: 1.8rem;
      cursor: pointer;
      opacity: 0.7;
      transition: opacity 0.2s;
    }

    .close-btn:hover { opacity: 1; }

    /* TERMINAL */
    .terminal {
      background: var(--dark-bg);
      backdrop-filter: blur(24px);
      border: 1px solid var(--border-color);
      border-radius: 24px;
      padding: 2rem;
      box-shadow: 0 24px 48px rgba(0,0,0,0.6), var(--glow);
      display: none;
      width: 100%;
    }

    .terminal.show { display: block; }

    /* WALLET HEADER */
    .wallet-header {
      display: none;
      background: linear-gradient(135deg, var(--cosmic-teal), var(--success-green));
      padding: 1.5rem;
      border-radius: 16px;
      margin-bottom: 1.5rem;
      text-align: center;
      box-shadow: 0 12px 32px rgba(6, 182, 212, 0.3);
    }

    .wallet-header.show { display: block; }

    .wallet-balance {
      font-size: clamp(1.5rem, 4vw, 2rem);
      font-weight: 900;
      color: var(--star-white);
      margin-bottom: 0.5rem;
      text-shadow: 0 0 12px rgba(255,255,255,0.6);
    }

    /* FORM ELEMENTS */
    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-label {
      color: var(--star-white);
      font-weight: 600;
      margin-bottom: 0.75rem;
      display: block;
      text-transform: uppercase;
      font-size: 0.85rem;
      letter-spacing: 0.5px;
    }

    .form-input, .form-select, textarea {
      width: 100%;
      padding: 1rem 1.25rem;
      border-radius: 16px;
      border: 1px solid var(--border-color);
      background: rgba(0, 0, 0, 0.4);
      color: var(--star-white);
      font-family: 'Roboto Mono', monospace;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .form-input:focus, .form-select:focus, textarea:focus {
      outline: none;
      border-color: var(--astro-purple);
      box-shadow: var(--glow);
      background: rgba(0, 0, 0, 0.6);
    }

    textarea {
      resize: vertical;
      min-height: 120px;
      font-size: 0.95rem;
    }

    /* BUTTONS */
    .btn {
      width: 100%;
      padding: 1.25rem;
      border-radius: 16px;
      border: none;
      font-family: 'Orbitron', monospace;
      font-weight: 700;
      cursor: pointer;
      text-transform: uppercase;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      font-size: 1rem;
      position: relative;
      overflow: hidden;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--astro-purple), var(--cosmic-teal));
      color: white;
      box-shadow: 0 12px 32px rgba(139, 92, 246, 0.4);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 20px 40px rgba(139, 92, 246, 0.6);
    }

    .btn-scan {
      background: linear-gradient(135deg, var(--astro-purple), var(--cosmic-teal));
      margin-bottom: 1.5rem;
      box-shadow: 0 8px 24px rgba(139, 92, 246, 0.3);
    }

    .btn-launch {
      background: linear-gradient(135deg, var(--cosmic-teal), var(--nebula-pink));
      font-size: 1.1rem;
      box-shadow: 0 12px 32px rgba(6, 182, 212, 0.4);
      margin-bottom: 1rem;
    }

    .btn-launch:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .btn-secondary {
      background: linear-gradient(135deg, var(--nebula-pink), var(--astro-purple));
      color: white;
      font-size: 0.9rem;
      padding: 0.875rem 1.5rem;
      width: auto;
      margin: 0 auto;
      display: inline-block;
      border-radius: 24px;
      opacity: 0.9;
    }

    .btn-secondary:hover {
      transform: translateY(-2px);
      opacity: 1;
      box-shadow: 0 12px 32px rgba(236, 72, 153, 0.5);
    }

    /* RESULTS */
    .result {
      display: none;
      margin: 1.5rem 0;
      padding: 2rem;
      border-radius: 20px;
      border: 2px solid var(--astro-purple);
      text-align: center;
      background: rgba(139, 92, 246, 0.12);
      position: relative;
    }

    .result.show { display: block; }

    .result-amount {
      font-size: clamp(2.5rem, 8vw, 3.5rem);
      color: var(--astro-purple);
      font-weight: 900;
      text-shadow: 0 0 20px rgba(139, 92, 246, 0.6);
      margin-bottom: 0.5rem;
    }

    .result-currency {
      position: absolute;
      top: 1.5rem;
      right: 2rem;
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--cosmic-teal);
    }

    /* QR CONTAINER */
    .qr-container {
      display: none;
      max-width: 260px;
      margin: 1.5rem auto;
      padding: 1.5rem;
      border-radius: 20px;
      border: 2px solid var(--border-color);
      background: rgba(0, 0, 0, 0.3);
      box-shadow: var(--glow);
    }

    .qr-container.show { display: block; }

    .qr-container img {
      display: none;
      width: 100%;
      height: auto;
      border-radius: 12px;
      max-width: 220px;
    }

    .qr-container.show img.active { display: block; }

    /* STATUS MESSAGES */
    .status {
      color: var(--cosmic-teal);
      font-size: 1.1rem;
      margin-bottom: 1.5rem;
      text-align: center;
      font-weight: 600;
      letter-spacing: 1px;
    }

    .status-success {
      color: var(--success-green);
      font-size: 1.1rem;
      margin-top: 1rem;
    }

    .status-error {
      color: var(--error-red);
      font-size: 1.1rem;
      margin-top: 1rem;
    }

    /* TITLES */
    .title {
      font-size: clamp(2rem, 6vw, 2.75rem);
      font-weight: 900;
      background: linear-gradient(135deg, var(--astro-purple), var(--cosmic-teal));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-align: center;
      margin-bottom: 1rem;
      letter-spacing: 1px;
    }

    .upload-area {
      background: linear-gradient(135deg, var(--nebula-pink), var(--cosmic-teal));
      padding: 1.25rem;
      text-align: center;
      border-radius: 16px;
      cursor: pointer;
      color: white;
      font-weight: 700;
      font-family: 'Orbitron', monospace;
      text-transform: uppercase;
      transition: all 0.3s ease;
      margin-bottom: 1.5rem;
    }

    .upload-area:hover {
      transform: translateY(-2px);
      box-shadow: 0 16px 40px rgba(236, 72, 153, 0.5);
    }

    input[type="file"] { display: none; }

    .contact-section {
      text-align: center;
      margin-top: 2rem;
      padding-top: 1.5rem;
      border-top: 1px solid var(--border-color);
    }

    /* RESPONSIVE */
    @media (max-width: 480px) {
      body { padding: 0.75rem; }
      .container { max-width: 100%; }
      .modal-content, .terminal { padding: 1.5rem; }
      .telegram-float { width: 56px; height: 56px; bottom: 20px; right: 20px; }
      .qr-container { max-width: 240px; padding: 1.25rem; }
    }

    @media (min-width: 768px) {
      .container { max-width: 480px; }
      .modal-content, .terminal { padding: 2.5rem; }
    }

    /* ANIMATIONS */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(24px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .terminal.show, .result.show, .qr-container.show {
      animation: fadeInUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
  </style>

  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>

<body>
  <div class="container">
    <!-- LOGIN MODAL -->
    <div id="loginModal" class="modal show">
      <div class="modal-content login-modal">
        <h1 class="title">üîê ACCESS TERMINAL</h1>
        <p style="color: var(--cosmic-teal); margin-bottom: 2rem; font-size: 1.1rem;">VERIFY YOUR IDENTITY</p>
        
        <div class="form-group">
          <label class="form-label">Email Address</label>
          <input type="email" class="form-input" id="userEmail" placeholder="your@email.com" required>
        </div>

        <div class="form-group">
          <label class="form-label">Country</label>
          <select class="form-select" id="userCountry" required>
            <option value="">Select Country</option>
            <option value="India">üáÆüá≥ India</option>
            <option value="USA">üá∫üá∏ USA</option>
            <option value="UK">üá¨üáß UK</option>
            <option value="Canada">üá®üá¶ Canada</option>
            <option value="Australia">üá¶üá∫ Australia</option>
            <option value="Other">üåç Other</option>
          </select>
        </div>

        <button class="btn btn-primary" onclick="verifyLogin()">üöÄ Enter Terminal</button>
      </div>
    </div>

    <!-- MAIN TERMINAL -->
    <div id="mainTerminal" class="terminal">
      <!-- WALLET HEADER -->
      <div id="walletHeader" class="wallet-header">
        <div class="wallet-balance" id="walletBalance">$0.0000</div>
        <div style="font-size: 1rem; color: var(--star-white); opacity: 0.9;">USDT Wallet Balance</div>
        <button class="btn btn-secondary" onclick="showFundModal()">‚ûï Add Funds</button>
      </div>

      <h1 class="title">AstroPulse</h1>
      <div class="status" id="statusText">INSTAGRAM BOOST SYSTEM</div>

      <form id="orderForm" enctype="multipart/form-data">
        <input type="hidden" name="_captcha" value="false">
        <input type="hidden" name="_subject" value="üåå AstroPulse Order">
        <input type="hidden" name="user_country" id="formCountry">
        <input type="hidden" name="user_email" id="formEmail">
        <input type="hidden" name="wallet_balance" id="formBalance">
        <input type="hidden" name="service_cost" id="formCost">

        <div class="form-group">
          <label class="form-label">Service</label>
          <select class="form-select" id="service" name="service" required onchange="toggleComments()">
            <option value="">Select Service</option>
            <option value="Likes">‚ù§Ô∏è Likes (‚Çπ15/1K | $0.18/1K)</option>
            <option value="Views">üëÅ Views (‚Çπ3/1K | $0.036/1K)</option>
            <option value="Shares">üîÑ Shares (‚Çπ5/1K | $0.06/1K)</option>
            <option value="Followers">üë§ Followers (‚Çπ20/1K | $0.24/1K)</option>
            <option value="Comments">üí¨ Comments (‚Çπ30/1K | $0.36/1K)</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">Post URL</label>
          <input type="url" class="form-input" name="post_link" placeholder="https://instagram.com/p/xxxxxxxxx" required>
        </div>

        <div class="form-group">
          <label class="form-label">Quantity (Min 100)</label>
          <input type="number" class="form-input" id="qty" name="quantity" min="100" step="100" placeholder="100, 500, 1000...">
        </div>

        <div class="form-group" id="commentBox" style="display: none;">
          <label class="form-label">Enter 5 Comments (One per line)</label>
          <textarea class="form-input" name="comments_text" placeholder="Nice post!
Amazing üî•
Great content
Love this ‚ù§Ô∏è
Keep it up üí™"></textarea>
        </div>

        <button type="button" class="btn btn-scan" onclick="scanTarget()">üîç Calculate Cost</button>

        <div id="result" class="result">
          <div class="result-currency" id="currencySymbol">‚Çπ</div>
          <div class="result-amount" id="amountValue">0.00</div>
          <div id="amountText">Payment Amount Locked</div>
          <div id="balanceOK" class="status status-success" style="display: none;">‚úÖ Sufficient balance!</div>
          <div id="balanceError" class="status status-error" style="display: none;">‚ùå Insufficient balance! Add funds first.</div>
        </div>

        <div id="qrContainer" class="qr-container">
          <img id="qrIndia" src="https://via.placeholder.com/260x260/4CAF50/FFFFFF?text=üáÆüá≥+UPI+QR+(India)" alt="India UPI QR">
          <img id="qrBinance" src="https://via.placeholder.com/260x260/FF9800/FFFFFF?text=ü™ô+USDT+BEP20+(BSC)" alt="BEP20 QR">
        </div>

        <label class="upload-area">
          üì∏ Upload Payment Screenshot
          <input type="file" name="payment_proof" accept="image/*">
        </label>

        <button type="submit" class="btn btn-launch" id="placeOrderBtn" disabled>üöÄ Place Order</button>
      </form>

      <div class="contact-section">
        <a href="mailto:developer9334@gmail.com" style="text-decoration: none;">
          <button class="btn btn-secondary">üìû Contact Support</button>
        </a>
      </div>
    </div>

    <!-- PAYMENT METHOD MODAL -->
    <div id="paymentMethodModal" class="modal">
      <div class="modal-content">
        <div class="title" style="margin-bottom: 1.5rem; font-size: 1.5rem;">üí≥ Choose Payment Method</div>
        
        <div class="form-group">
          <button class="btn btn-primary" style="margin-bottom: 1rem;" onclick="selectPaymentMethod('bep20')">
            ü™ô BEP20 (BSC)<br><small style="font-size: 0.85rem; opacity: 0.8;">Scan QR Code</small>
          </button>
          <button class="btn btn-primary" onclick="selectPaymentMethod('binance')">
            üì± Binance Pay ID<br><small style="font-size: 0.85rem; opacity: 0.8;">Pay on Binance</small>
          </button>
        </div>
      </div>
    </div>

    <!-- FUND MODAL -->
    <div id="fundModal" class="modal">
      <div class="modal-content">
        <button class="close-btn" onclick="closeFundModal()">√ó</button>
        <h2 class="title" id="fundTitle" style="font-size: 1.6rem; margin-bottom: 1rem;">üí∞ Add Funds</h2>
        <p style="color: var(--star-white); margin-bottom: 1.5rem; opacity: 0.9;" id="fundInstruction">Send USDT to continue ordering</p>

        <div id="bep20Section" style="display: none; text-align: center; margin-bottom: 1.5rem;">
          <div class="qr-container">
            <img id="qrFunds" src="https://via.placeholder.com/260x260/FBC02D/000000?text=üí∞+BEP20+USDT" alt="BEP20 QR">
          </div>
          <p style="color: var(--cosmic-teal); font-size: 0.95rem; margin-top: 0.5rem;">
            BEP20 Network (BSC) ‚Ä¢ USDT
          </p>
        </div>

        <div id="binanceSection" class="payment-info" style="display: none; background: rgba(16, 185, 129, 0.15);">
          <div style="font-size: 1.25rem; font-weight: 700; color: var(--success-green); margin-bottom: 0.5rem;">
            Pay on: 1129383806
          </div>
          <div style="font-size: 0.9rem; opacity: 0.9;">Copy this ID in Binance Pay</div>
        </div>

        <div class="form-group">
          <label class="form-label">Amount (USDT)</label>
          <input type="number" class="form-input" id="fundAmount" min="1" step="0.1" placeholder="5.00, 10.00...">
        </div>

        <button class="btn btn-primary" onclick="confirmAddFunds()">‚úÖ Confirm Payment</button>
        <p style="color: var(--cosmic-teal); font-size: 0.85rem; margin-top: 1rem; opacity: 0.9;">
          Screenshot will be sent for verification
        </p>
      </div>
    </div>
  </div>

  <!-- TELEGRAM BUTTON -->
  <a href="https://t.me/yyaaams" target="_blank" class="telegram-float pulse" id="telegramFloat">
    <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
      <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472l-.004.041z"/>
    </svg>
  </a>

  <script>
    // GLOBAL STATE
    const state = {
      isCalculated: false,
      userCountry: '',
      userEmail: '',
      walletBalance: 0.0,
      selectedPaymentMethod: '',
      INR_TO_USDT: 0.012
    };

    // DOM ELEMENTS
    const elements = {
      telegramBtn: null,
      loginModal: null,
      mainTerminal: null,
      walletHeader: null
    };

    // RATES
    const RATES_INR = { Likes: 15, Views: 3, Shares: 5, Followers: 20, Comments: 30 };

    // INIT
    document.addEventListener('DOMContentLoaded', init);

    function init() {
      elements.telegramBtn = document.getElementById('telegramFloat');
      elements.loginModal = document.getElementById('loginModal');
      elements.mainTerminal = document.getElementById('mainTerminal');
      elements.walletHeader = document.getElementById('walletHeader');
      
      // Form submit
      document.getElementById('orderForm').addEventListener('submit', handleOrderSubmit);
      
      // Modal backdrop clicks
      document.getElementById('fundModal').addEventListener('click', e => e.target === e.currentTarget && closeFundModal());
      document.getElementById('paymentMethodModal').addEventListener('click', e => e.target === e.currentTarget && hidePaymentMethodModal());
      
      // Enter key for login
      document.addEventListener('keypress', e => {
        if (e.key === 'Enter' && elements.loginModal.classList.contains('show')) verifyLogin();
      });
    }

    function verifyLogin() {
      const email = document.getElementById('userEmail').value;
      const country = document.getElementById('userCountry').value;
      
      if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
        alert('Please enter a valid email address!');
        document.getElementById('userEmail').focus();
        return;
      }
      
      if (!country) {
        alert('Please select your country!');
        return;
      }

      state.userCountry = country;
      state.userEmail = email;
      
      document.getElementById('formCountry').value = country;
      document.getElementById('formEmail').value = email;
      
      // Show wallet for non-India users
      if (state.userCountry !== 'India') {
        elements.walletHeader.classList.add('show');
        updateWalletDisplay();
      }
      
      // Update status
      document.getElementById('statusText').textContent = 
        state.userCountry === 'India' ? 'üáÆüá≥ INSTAGRAM BOOST SYSTEM (INR)' : 'üåç INSTAGRAM BOOST SYSTEM (USDT)';
      
      // Switch screens
      elements.loginModal.classList.remove('show');
      elements.mainTerminal.classList.add('show');
      
      // Show telegram button
      setTimeout(() => {
        elements.telegramBtn.classList.add('show', 'pulse');
      }, 400);
    }

    function showFundModal() {
      if (state.userCountry === 'India') {
        alert('üáÆüá≥ Indian users pay via QR after calculating cost!');
        return;
      }
      document.getElementById('paymentMethodModal').classList.add('show');
    }

    function selectPaymentMethod(method) {
      state.selectedPaymentMethod = method;
      document.getElementById('paymentMethodModal').classList.remove('show');
      document.getElementById('fundModal').classList.add('show');
      
      const fundTitle = document.getElementById('fundTitle');
      const fundInstruction = document.getElementById('fundInstruction');
      
      if (method === 'bep20') {
        fundTitle.textContent = 'ü™ô BEP20 Payment';
        fundInstruction.textContent = 'Scan QR Code & Send USDT (BEP20)';
        document.getElementById('bep20Section').style.display = 'block';
        document.getElementById('binanceSection').style.display = 'none';
      } else {
        fundTitle.textContent = 'üì± Binance Pay';
        fundInstruction.textContent = 'Send USDT via Binance Pay ID';
        document.getElementById('bep20Section').style.display = 'none';
        document.getElementById('binanceSection').style.display = 'block';
      }
    }

    function closeFundModal() {
      document.getElementById('fundModal').classList.remove('show');
      document.getElementById('bep20Section').style.display = 'none';
      document.getElementById('binanceSection').style.display = 'none';
      document.getElementById('fundAmount').value = '';
      state.selectedPaymentMethod = '';
    }

    function hidePaymentMethodModal() {
      document.getElementById('paymentMethodModal').classList.remove('show');
    }

    function confirmAddFunds() {
      const amount = parseFloat(document.getElementById('fundAmount').value);
      
      if (!amount || amount < 1) {
        alert('Enter minimum $1.00 USDT');
        return;
      }
      
      if (!state.selectedPaymentMethod) {
        alert('Please select a payment method first!');
        return;
      }

      // Submit fund form
      const formData = new FormData();
      formData.append('_subject', 'üí∞ AstroPulse FUND ADDITION');
      formData.append('user_email', state.userEmail);
      formData.append('user_country', state.userCountry);
      formData.append('fund_amount', amount);
      formData.append('payment_method', state.selectedPaymentMethod.toUpperCase());
      formData.append('fund_status', 'PENDING');
      formData.append('_captcha', 'false');

      fetch('https://formsubmit.co/developer9155@gmail.com', {
        method: 'POST',
        body: formData
      }).then(() => {
        state.walletBalance += amount;
        updateWalletDisplay();
        closeFundModal();
        alert(`‚úÖ $${amount.toFixed(4)} added to wallet!\nTotal: $${state.walletBalance.toFixed(4)} USDT`);
      }).catch(() => {
        state.walletBalance += amount;
        updateWalletDisplay();
        closeFundModal();
        alert(`‚úÖ $${amount.toFixed(4)} added to wallet!\nTotal: $${state.walletBalance.toFixed(4)} USDT`);
      });
    }

    function updateWalletDisplay() {
      document.getElementById('walletBalance').textContent = `$${state.walletBalance.toFixed(4)}`;
      document.getElementById('formBalance').value = state.walletBalance.toFixed(4);
    }

    function toggleComments() {
      const service = document.getElementById('service').value;
      document.getElementById('commentBox').style.display = service === 'Comments' ? 'block' : 'none';
    }

    function scanTarget() {
      const service = document.getElementById('service').value;
      const quantity = parseInt(document.getElementById('qty').value);
      
      if (!service || quantity < 100) {
        alert('Select service & minimum 100 quantity');
        return;
      }

      // Validate comments
      if (service === 'Comments') {
        const comments = document.querySelector('[name="comments_text"]').value.trim();
        const lines = comments.split('\n').filter(line => line.trim());
        if (lines.length < 5) {
          alert('Enter at least 5 comments (one per line)');
          return;
        }
      }

      // Calculate cost
      const costINR = (quantity / 1000) * RATES_INR[service];
      let finalCost, currency, symbol;
      
      if (state.userCountry === 'India') {
        finalCost = costINR;
        currency = 'INR';
        symbol = '‚Çπ';
      } else {
        finalCost = costINR * state.INR_TO_USDT;
        currency = 'USDT';
        symbol = '$';
      }

      // Update UI
      document.getElementById('amountValue').textContent = finalCost.toFixed(4);
      document.getElementById('currencySymbol').textContent = symbol;
      document.getElementById('amountText').textContent = `Payment Amount Locked (${currency})`;
      document.getElementById('formCost').value = finalCost.toFixed(4);
      
      // Show QR
      const qrContainer = document.getElementById('qrContainer');
      qrContainer.classList.add('show');
      
      document.querySelectorAll('.qr-container img').forEach(img => {
        img.classList.remove('active');
        img.style.display = 'none';
      });
      
      const qrId = state.userCountry === 'India' ? 'qrIndia' : 'qrBinance';
      document.getElementById(qrId).classList.add('active');
      
      // Show result
      document.getElementById('result').classList.add('show');
      state.isCalculated = true;
      
      // Balance check for non-India users
      if (state.userCountry !== 'India') {
        if (state.walletBalance >= finalCost) {
          document.getElementById('balanceOK').style.display = 'block';
          document.getElementById('balanceError').style.display = 'none';
          document.getElementById('placeOrderBtn').disabled = false;
        } else {
          document.getElementById('balanceError').style.display = 'block';
          document.getElementById('balanceOK').style.display = 'none';
          document.getElementById('placeOrderBtn').disabled = true;
        }
      } else {
        document.getElementById('placeOrderBtn').disabled = false;
      }
      
      document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
    }

    function handleOrderSubmit(e) {
      e.preventDefault();
      
      if (!state.isCalculated) {
        alert('Please calculate cost first! üîç');
        return;
      }
      
      const cost = parseFloat(document.getElementById('formCost').value);
      
      if (state.userCountry !== 'India' && state.walletBalance < cost) {
        alert('Insufficient balance! Add funds first.');
        return;
      }
      
      // Deduct balance for non-India users
      if (state.userCountry !== 'India') {
        state.walletBalance -= cost;
        updateWalletDisplay();
      }
      
      // Submit form
      const formData = new FormData(e.target);
      fetch('https://formsubmit.co/developer9155@gmail.com', {
        method: 'POST',
        body: formData
      }).then(() => {
        alert('üöÄ Order placed successfully!');
        elements.telegramBtn.classList.remove('pulse');
        elements.telegramBtn.classList.add('hidden');
        e.target.reset();
        resetUI();
      });
    }

    function resetUI() {
      document.getElementById('result').classList.remove('show');
      document.getElementById('qrContainer').classList.remove('show');
      document.getElementById('commentBox').style.display = 'none';
      document.getElementById('placeOrderBtn').disabled = true;
      state.isCalculated = false;
    }
  </script>
</body>
</html>
